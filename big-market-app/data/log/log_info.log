24-05-22.18:56:57.305 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_231 on Trumen with PID 50464 (started by Admin in E:\Project\Job\xfg\big-market\big-market-app)
24-05-22.18:56:57.306 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
24-05-22.18:56:58.427 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-05-22.18:56:58.430 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-05-22.18:56:58.483 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 26 ms. Found 0 Redis repository interfaces.
24-05-22.18:57:00.561 [main            ] INFO  Version                - Redisson 3.23.4
24-05-22.18:57:01.011 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 47.120.8.26/47.120.8.26:16379
24-05-22.18:57:01.109 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 47.120.8.26/47.120.8.26:16379
24-05-22.18:57:04.029 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-05-22.18:57:04.111 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [47.120.8.26:5672]
24-05-22.18:57:04.212 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#286866cb:0/SimpleConnection@3c8758d1 [delegate=amqp://admin@47.120.8.26:5672/, localPort= 46181]
24-05-22.18:57:04.405 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 7.59 seconds (JVM running for 8.636)
24-05-22.18:57:04.822 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.18:57:05.021 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.18:57:05.021 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.18:57:05.184 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.18:57:05.185 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.18:57:05.187 [pool-3-thread-1 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.18:57:05.441 [main            ] INFO  RaffleActivityController - 活动装配，数据预热，完成 activityID: 100301
24-05-22.18:57:05.601 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":true,"info":"0000"}
24-05-22.18:57:05.630 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-05-22.18:57:05.643 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-05-22.18:57:06.359 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-05-22.18:57:06.417 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-05-22.18:57:06.419 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-05-22.18:57:06.420 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-05-22.18:57:12.137 [main            ] INFO  RaffleActivityControllerTest - Starting RaffleActivityControllerTest using Java 1.8.0_231 on Trumen with PID 11468 (started by Admin in E:\Project\Job\xfg\big-market\big-market-app)
24-05-22.18:57:12.138 [main            ] INFO  RaffleActivityControllerTest - The following 1 profile is active: "dev"
24-05-22.18:57:13.047 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-05-22.18:57:13.050 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-05-22.18:57:13.093 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 30 ms. Found 0 Redis repository interfaces.
24-05-22.18:57:14.893 [main            ] INFO  Version                - Redisson 3.23.4
24-05-22.18:57:15.331 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 47.120.8.26/47.120.8.26:16379
24-05-22.18:57:15.422 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 47.120.8.26/47.120.8.26:16379
24-05-22.18:57:18.080 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-05-22.18:57:18.165 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [47.120.8.26:5672]
24-05-22.18:57:18.261 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#286866cb:0/SimpleConnection@3c8758d1 [delegate=amqp://admin@47.120.8.26:5672/, localPort= 46298]
24-05-22.18:57:18.476 [main            ] INFO  RaffleActivityControllerTest - Started RaffleActivityControllerTest in 6.735 seconds (JVM running for 7.69)
24-05-22.18:57:18.705 [main            ] INFO  RaffleActivityController - 活动抽奖 userID: qiuming, activityID: 100301
24-05-22.18:57:18.816 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.18:57:19.146 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.18:57:19.350 [main            ] INFO  RaffleActivityController - 活动抽奖，创建订单 userID: qiuming, activityID: 100301
24-05-22.18:57:19.402 [main            ] INFO  DefaultLogicChain      - 抽奖责任链-默认处理 userID: qiuming strategyID: 100006 ruleModel: rule_default awardId: 103
24-05-22.18:57:19.402 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-责任链 qiuming 100006 103 rule_default
24-05-22.18:57:19.402 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.18:57:19.494 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.18:57:19.521 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减 userId:qiuming strategyId:100006 awardId:103
24-05-22.18:57:19.539 [main            ] INFO  RuleStockLogicTreeNode - 规则过滤-库存扣减-成功 userId: qiuming strategyId: 100006 awardId: 103
24-05-22.18:57:19.586 [main            ] INFO  DecisionTreeEngine     - 决策树引擎【规则树-兜底奖励】treeId:tree_luck_award node:rule_stock code:0001
24-05-22.18:57:19.586 [main            ] INFO  AbstractRaffleStrategy - 抽奖策略计算-规则树 qiuming 100006 103 null
24-05-22.18:57:19.864 [main            ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"支付优惠券","userId":"qiuming"},"id":"18351399853","timestamp":1716375439619}
24-05-22.18:57:19.880 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"支付优惠券","userId":"qiuming"},"id":"18351399853","timestamp":1716375439619}
24-05-22.18:57:19.930 [main            ] ERROR AwardRepository        - 写入中奖记录，发送MQ消息失败 userId: qiuming topic: send_award
24-05-22.18:57:19.965 [main            ] INFO  RaffleActivityControllerTest - 请求参数：{"activityId":100301,"userId":"qiuming"}
24-05-22.18:57:19.968 [main            ] INFO  RaffleActivityControllerTest - 测试结果：{"code":"0000","data":{"awardId":103,"awardIndex":3,"awardTitle":"支付优惠券"},"info":"成功"}
24-05-22.18:57:19.990 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-05-22.18:57:19.999 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-05-22.18:57:20.007 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.18:57:20.018 [pool-3-thread-3 ] INFO  EventPublisher         - 发送MQ消息 topic:send_award message:{"data":{"awardId":103,"awardTitle":"支付优惠券","userId":"qiuming"},"id":"18351399853","timestamp":1716375439619}
24-05-22.18:57:20.037 [pool-3-thread-3 ] ERROR SendMessageTaskJob     - 定时任务，发送MQ消息失败 userId: qiuming topic: send_award
24-05-22.18:57:20.116 [pool-3-thread-2 ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.18:57:20.403 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-05-22.18:57:20.893 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-05-22.18:57:20.896 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-05-22.18:57:20.897 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-05-22.19:00:45.053 [main            ] INFO  RaffleStrategyControllerTest - Starting RaffleStrategyControllerTest using Java 1.8.0_231 on Trumen with PID 13340 (started by Admin in E:\Project\Job\xfg\big-market\big-market-app)
24-05-22.19:00:45.054 [main            ] INFO  RaffleStrategyControllerTest - The following 1 profile is active: "dev"
24-05-22.19:00:45.961 [main            ] INFO  RepositoryConfigurationDelegate - Multiple Spring Data modules found, entering strict repository configuration mode
24-05-22.19:00:45.964 [main            ] INFO  RepositoryConfigurationDelegate - Bootstrapping Spring Data Redis repositories in DEFAULT mode.
24-05-22.19:00:46.010 [main            ] INFO  RepositoryConfigurationDelegate - Finished Spring Data repository scanning in 31 ms. Found 0 Redis repository interfaces.
24-05-22.19:00:47.802 [main            ] INFO  Version                - Redisson 3.23.4
24-05-22.19:00:48.227 [redisson-netty-2-4] INFO  MasterPubSubConnectionPool - 1 connections initialized for 47.120.8.26/47.120.8.26:16379
24-05-22.19:00:48.344 [redisson-netty-2-13] INFO  MasterConnectionPool   - 5 connections initialized for 47.120.8.26/47.120.8.26:16379
24-05-22.19:00:50.978 [main            ] INFO  EndpointLinksResolver  - Exposing 1 endpoint(s) beneath base path '/actuator'
24-05-22.19:00:51.078 [main            ] INFO  CachingConnectionFactory - Attempting to connect to: [47.120.8.26:5672]
24-05-22.19:00:51.187 [main            ] INFO  CachingConnectionFactory - Created new connection: rabbitConnectionFactory#286866cb:0/SimpleConnection@3c8758d1 [delegate=amqp://admin@47.120.8.26:5672/, localPort= 46595]
24-05-22.19:00:51.354 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-1] INFO  SendAwardCustomer      - 监听用户奖品发送消息 topic: send_award message: {"data":{"awardId":103,"awardTitle":"支付优惠券","userId":"qiuming"},"id":"18351399853","timestamp":1716375439619}
24-05-22.19:00:51.361 [main            ] INFO  RaffleStrategyControllerTest - Started RaffleStrategyControllerTest in 6.734 seconds (JVM running for 7.668)
24-05-22.19:00:51.572 [main            ] INFO  RaffleStrategyController - 抽奖装配策略开始：用户ID：qiuming strategyID: 100301
24-05-22.19:00:51.601 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.19:00:51.929 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.19:00:52.069 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Starting...
24-05-22.19:00:52.233 [main            ] INFO  HikariDataSource       - Retail_HikariCP - Start completed.
24-05-22.19:00:52.420 [main            ] INFO  RaffleStrategyController - 抽奖装配策略完成： userID: qiuming activityID: 100301, response: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnlockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnlockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnlockCount":0}],"info":"成功"}
24-05-22.19:00:52.423 [main            ] INFO  RaffleStrategyControllerTest - 请求参数: {"activityId":100301,"userId":"qiuming"}
24-05-22.19:00:52.423 [main            ] INFO  RaffleStrategyControllerTest - 测试结果: {"code":"0000","data":[{"awardId":101,"awardTitle":"随机积分","isAwardUnlock":true,"sort":1,"waitUnlockCount":0},{"awardId":102,"awardTitle":"OpenAI会员卡","isAwardUnlock":true,"sort":2,"waitUnlockCount":0},{"awardId":103,"awardTitle":"支付优惠券","isAwardUnlock":true,"sort":3,"waitUnlockCount":0},{"awardId":104,"awardTitle":"小米台灯","isAwardUnlock":true,"sort":4,"waitUnlockCount":0},{"awardId":105,"awardRuleLockCount":3,"awardSubtitle":"抽奖3次后解锁","awardTitle":"小米su7周体验","isAwardUnlock":false,"sort":5,"waitUnlockCount":2},{"awardId":106,"awardRuleLockCount":2,"awardSubtitle":"抽奖2次后解锁","awardTitle":"轻奢办公椅","isAwardUnlock":false,"sort":6,"waitUnlockCount":1},{"awardId":107,"awardRuleLockCount":1,"awardSubtitle":"抽奖1次后解锁","awardTitle":"小霸王游戏机","isAwardUnlock":false,"sort":7,"waitUnlockCount":0},{"awardId":108,"awardTitle":"暴走玩偶","isAwardUnlock":true,"sort":8,"waitUnlockCount":0}],"info":"成功"}
24-05-22.19:00:52.449 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-05-22.19:00:52.462 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Waiting for workers to finish.
24-05-22.19:00:53.322 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#0-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-05-22.19:00:53.380 [org.springframework.amqp.rabbit.RabbitListenerEndpointContainer#1-2] INFO  SimpleMessageListenerContainer - Successfully waited for workers to finish.
24-05-22.19:00:53.382 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
24-05-22.19:00:53.382 [SpringApplicationShutdownHook] INFO  SimpleMessageListenerContainer - Shutdown ignored - container is already stopped
